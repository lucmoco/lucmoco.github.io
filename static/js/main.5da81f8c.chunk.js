(this.webpackJsonpboussole=this.webpackJsonpboussole||[]).push([[0],{1:function(e,t,a){e.exports={taskList:"Tasks_taskList__1j01R",tasksFilter:"Tasks_tasksFilter__SByHK",visible:"Tasks_visible__2gUcH",tasksFilterInner:"Tasks_tasksFilterInner__37v1d",taskFilterText:"Tasks_taskFilterText__1lomt",tasks:"Tasks_tasks__4y0vu",tasksButtons:"Tasks_tasksButtons__XJ-pN",task:"Tasks_task__3bw5D",title:"Tasks_title__1CtZZ",taskForm:"Tasks_taskForm__oi8da",button:"Tasks_button__25aul",taskStateIndicator:"Tasks_taskStateIndicator__3zudG",notCurrent:"Tasks_notCurrent__21dv8",clickable:"Tasks_clickable__fAQfc",thickBorder:"Tasks_thickBorder__3vSP1",small:"Tasks_small__eHZhy",created:"Tasks_created__3OKBO","in-backlog":"Tasks_in-backlog__1cBRA",active:"Tasks_active__c-6hh",finished:"Tasks_finished__dGaVL",abandoned:"Tasks_abandoned__-2J94",taskStateClosed:"Tasks_taskStateClosed__2ySBA"}},16:function(e,t,a){e.exports={dialog:"Dialog_dialog__2jZTN",title:"Dialog_title__1r951",content:"Dialog_content__3EOpS",buttons:"Dialog_buttons__1OnQ6"}},17:function(e,t,a){e.exports={iconDesigner:"IconDesigner_iconDesigner__FdLiT",iconPreview:"IconDesigner_iconPreview__2680x"}},18:function(e,t,a){e.exports={button:"Button_button___qM3V",wide:"Button_wide__3ejWw",light:"Button_light__2KPpW"}},20:function(e,t,a){e.exports={field:"Field_field__1UM57",label:"Field_label__2F_cw"}},26:function(e,t,a){e.exports={app:"App_app__32N6G"}},29:function(e,t,a){e.exports={overlay:"Overlay_overlay__3WkJQ"}},30:function(e,t,a){e.exports={spaceOutVerticalComponents:"Spacing_spaceOutVerticalComponents__x2Ed8"}},35:function(e,t,a){e.exports=a(47)},40:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(25),c=a.n(i),s=(a(40),a(14)),o=a(26),l=a.n(o),u=a(11),d=a(7),f=a(13),m=a(33),h=a(27),v=a(34),k=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={isError:!1,error:null},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidCatch",value:function(e,t){this.setState({isError:!0,error:t})}},{key:"render",value:function(){return this.state.isError?n.createElement("div",null,this.state.error.componentStack):this.props.children}}]),t}(n.Component),p=a(3),b=a(1),_=a.n(b),E=a(4),g=a.n(E),C=a(9),x=a(10);function w(e){for(var t="",a=0;a<e;a++)t+="0123456789abcdef".charAt(Math.floor(Math.random()*"0123456789abcdef".length));return t}var O=function(e){return{state:e,dateClosed:"finished"===e||"abandoned"===e?new Date:void 0}},T=function e(t){var a=this;Object(d.a)(this,e),this.store=void 0,this.getTasks=function(){return a.store.getState()},this.setTasks=function(e){return a.store.setState(e)},this.createTask=function(e){a.store.updateState((function(t){var a="".concat(w(8),"-").concat(w(4),"-").concat(w(4),"-").concat(w(4),"-").concat(w(12)),n=new Date;return t[a]=Object(x.a)({},e,{id:a,created:n,modified:n}),Object(x.a)({},t)}))},this.updateTask=function(e,t){a.store.updateState((function(a){var n=a[e];if(!n)throw new Error("No task found with id {id}");return a[e]=Object(x.a)({},n,{},t),Object(x.a)({},a)}))},this.store=t},j=a(28),S=["https://graph.microsoft.com/Files.ReadWrite"],y=function(){function e(){Object(d.a)(this,e),this.account=void 0,this.application=new j.a({auth:{clientId:"c1fef6c7-2dd3-425b-aa1e-e9c94ca00c63",authority:"https://login.microsoftonline.com/consumers/"}})}return Object(f.a)(e,[{key:"authenticate",value:function(){var e=Object(C.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.application.handleRedirectPromise();case 2:if(0!==(t=this.application.getAllAccounts()).length){e.next=6;break}return e.next=6,this.application.loginRedirect();case 6:this.account=t[0];case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"acquireToken",value:function(){var e=Object(C.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authenticate();case 2:return e.next=4,this.application.acquireTokenSilent({scopes:S,account:this.account});case 4:return t=e.sent,e.abrupt("return",t.accessToken);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),N=function(){function e(t){Object(d.a)(this,e),this.authManager=void 0,this.authManager=t}return Object(f.a)(e,[{key:"loadData",value:function(){var e=Object(C.a)(g.a.mark((function e(){var t,a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authManager.acquireToken();case 2:return t=e.sent,e.next=5,fetch("https://graph.microsoft.com/v1.0/me/drive/root:/boussole-data-files/notes.json:/content",{headers:{Authorization:"Bearer "+t}});case 5:return a=e.sent,e.next=8,a.json();case 8:return n=e.sent,e.abrupt("return",D(n));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveData",value:function(){var e=Object(C.a)(g.a.mark((function e(t){var a,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=B(t),e.next=3,this.authManager.acquireToken();case 3:return n=e.sent,e.next=6,fetch("https://graph.microsoft.com/v1.0/me/drive/root:/boussole-data-files/notes.json:/content",{method:"PUT",headers:{"Content-Type":"text/plain",Authorization:"Bearer "+n},body:JSON.stringify(a,null,"  ")});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function B(e){var t,a=[];for(var n in e)a.push({state:"created"===(t=e[n]).state?void 0:t.state,id:t.id,title:t.title,description:t.description||void 0,created:t.created,modified:t.modified,dateClosed:t.dateClosed});return{tasks:a}}function D(e){var t={};return e.tasks.forEach((function(e){return t[e.id]=function(e){return{state:e.state||"created",id:e.id,title:e.title,description:e.description||"",created:e.created,modified:e.modified,dateClosed:e.dateClosed}}(e)})),t}var F=function e(t){var a=this;Object(d.a)(this,e),this.state=void 0,this.callbacks=void 0,this.getState=function(){return a.state},this.setState=function(e){a.state=e,a.notify()},this.updateState=function(e){var t=e(a.state);t!==a.state&&(a.state=t,a.notify())},this.subscribe=function(e){if(a.callbacks.indexOf(e)>=0)throw new Error("The callback is already registered.");return a.callbacks.push(e),function(){a.callbacks=a.callbacks.filter((function(t){return t!==e}))}},this.notify=function(){var e=a.state,t=!0,n=!1,r=void 0;try{for(var i,c=a.callbacks[Symbol.iterator]();!(t=(i=c.next()).done);t=!0){var s=i.value;if(a.state!==e)return;a.callbacks.indexOf(s)<0||s(e)}}catch(o){n=!0,r=o}finally{try{t||null==c.return||c.return()}finally{if(n)throw r}}},this.state=t,this.callbacks=[]},M=r.a.createContext(void 0),A=r.a.createContext(void 0),L=r.a.createContext(void 0),I=function(e){var t=e.dataStore,a=e.taskStore,n=e.children,i=r.a.useState(a.getState()),c=Object(p.a)(i,2),s=c[0],o=c[1],l=r.a.useMemo((function(){return new T(a)}),[a]),u=function(e,t){var a=r.a.useRef({}),n=r.a.useState("all-saved"),i=Object(p.a)(n,2),c=i[0],s=i[1],o=r.a.useCallback((function(t){a.current.modelBeingSaved?a.current.modelToSave=t:Object(C.a)(g.a.mark((function n(){return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a.current={modelBeingSaved:t},s("saving"),n.next=4,e.saveData(t);case 4:if(!a.current.modelToSave){n.next=10;break}return a.current={modelBeingSaved:t},n.next=8,e.saveData(t);case 8:n.next=4;break;case 10:a.current={},s("all-saved");case 12:case"end":return n.stop()}}),n)})))()}),[e]);return r.a.useEffect((function(){return t.subscribe(o)}),[t,o]),c}(t,a);return r.a.useEffect((function(){return a.subscribe(o)}),[a]),r.a.createElement(M.Provider,{value:s},r.a.createElement(A.Provider,{value:l},r.a.createElement(L.Provider,{value:u},n)))},P=function(e){var t=e.children,a=r.a.useMemo((function(){return new y}),[]),n=r.a.useMemo((function(){return new N(a)}),[a]),i=r.a.useState(void 0),c=Object(p.a)(i,2),s=c[0],o=c[1];return r.a.useEffect((function(){Object(C.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadData();case 2:t=e.sent,a=new F(t),o(a);case 5:case"end":return e.stop()}}),e)})))()}),[n]),s?r.a.createElement(I,{dataStore:n,taskStore:s},t):null},z=function(){return r.a.useContext(A)},W=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((function(e){return!!e})).join(" ")},H=function(e){switch(e){case"created":return"En attente";case"in-backlog":return"Dans le radar";case"active":return"En cours";case"finished":return"Termin\xe9e";case"abandoned":return"Abandonn\xe9e"}},V=function(e){var t=e.state,a=e.showText,n=e.showCurrentBorder,i=e.showNotCurrent,c=e.onClick;return r.a.createElement("div",{title:a?void 0:H(t),className:W(_.a.taskStateIndicator,_.a[t],!a&&_.a.small,n&&_.a.thickBorder,i&&_.a.notCurrent,c&&_.a.clickable),onClick:c?function(e){e.stopPropagation(),c()}:void 0},a&&H(t))},J=a(16),R=a.n(J),q=a(29),Z=a.n(q),G=function(e){var t=e.children;return r.a.createElement("div",{className:Z.a.overlay},t)},K=a(18),Q=a.n(K),U=function(e){var t=e.isLight,a=e.isWide,n=e.title,i=e.onClick,c=e.children;return r.a.createElement("div",{className:W(Q.a.button,t&&Q.a.light,a&&Q.a.wide),title:n,onClick:i},c)},X=function(e){var t=e.title,a=e.buttons,n=e.children;return r.a.createElement(G,null,r.a.createElement("div",{className:R.a.dialog},t&&r.a.createElement("div",{className:R.a.title},t),r.a.createElement("div",{className:R.a.content},n),a&&r.a.createElement("div",{className:R.a.buttons},a.map((function(e){return r.a.createElement(U,{isWide:!0,onClick:e.onclick},e.text)})))))},$=a(30),Y=a.n($),ee=function(e){var t=e.state,a=e.onChange,n=r.a.useCallback((function(e){return r.a.createElement(V,{state:e,showText:!0,showCurrentBorder:e===t,showNotCurrent:e!==t,onClick:e===t?void 0:function(){a(e)}})}),[t,a]);return r.a.createElement("div",{className:Y.a.spaceOutVerticalComponents},n("created"),n("in-backlog"),n("active"),r.a.createElement("div",{className:_.a.taskStateClosed},n("finished"),n("abandoned")))},te=function(e){var t=e.state,a=e.onClose;return r.a.createElement(X,{buttons:[{text:"Annuler",onclick:function(){a()}}]},r.a.createElement(ee,{state:t,onChange:a}))},ae=a(20),ne=a.n(ae),re=function(e){var t=e.label,a=e.children;return r.a.createElement("div",{className:ne.a.field},r.a.createElement("div",{className:ne.a.label},t),r.a.createElement("div",null,a))},ie=function(e){var t=e.task,a=e.onChange;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,{state:t.state,onChange:function(e){return a(Object(x.a)({},t,{},O(e)))}}),r.a.createElement(re,{label:"titre"},r.a.createElement("input",{type:"text",value:t.title,onChange:function(e){return a(Object(x.a)({},t,{title:e.target.value}))}})),r.a.createElement(re,{label:"description"},r.a.createElement("textarea",{value:t.description,onChange:function(e){return a(Object(x.a)({},t,{description:e.target.value}))}})))};function ce(e){var t=Object(n.useMemo)((function(){return e.task?e.task.id:void 0}),[e.task]),a=Object(n.useState)(e.task||{id:"",state:"created",title:"",description:"",created:new Date,modified:new Date}),i=Object(p.a)(a,2),c=i[0],s=i[1],o=z(),l=o.createTask,u=o.updateTask;return r.a.createElement(X,{title:t?"Modifier une t\xe2che":"Nouvelle t\xe2che",buttons:[{text:"Valider",onclick:function(){t?u(t,c):l(c),e.onClose()}},{text:"Annuler",onclick:e.onClose}]},r.a.createElement(ie,{task:c,onChange:s}))}var se=function(e){var t=e.task,a=z().updateTask,n=r.a.useState(!1),i=Object(p.a)(n,2),c=i[0],s=i[1],o=r.a.useState(!1),l=Object(p.a)(o,2),u=l[0],d=l[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{onClick:function(){return s(!0)},className:_.a.task},r.a.createElement("div",{className:_.a.title},t.title),r.a.createElement(V,{state:t.state,onClick:function(){return d(!0)}})),c&&r.a.createElement(ce,{task:t,onClose:function(){return s(!1)}}),u&&r.a.createElement(te,{state:t.state,onClose:function(e){d(!1),e&&a(t.id,O(e))}}))},oe=function(e){var t=e.headerControls,a=e.children,n=r.a.useContext(L);return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",null,r.a.createElement(s.b,{to:"/home"},"Home"),r.a.createElement(s.b,{to:"/tasks"},"T\xe2ches"),t,n),r.a.createElement("section",null,a))},le=function(e){return r.a.createElement("svg",Object.assign({},e,{viewBox:"0 0 10 10"}),r.a.createElement("path",{d:"M 0.25,1.5 4.25,6 v 3.75 H 5.75 V 6 l 4,-4.5 v -1.25 l -9.5,0 z",fill:"none",strokeWidth:.5,strokeLinecap:"butt",strokeLinejoin:"miter",strokeMiterlimit:4}))},ue=function(e){var t=e.visible,a=e.text,n=e.textChanged;return r.a.createElement("div",{className:W(_.a.tasksFilter,t&&_.a.visible)},r.a.createElement("div",{className:_.a.tasksFilterInner},r.a.createElement("input",{className:_.a.taskFilterText,value:a,onChange:function(e){return n(e.target.value)}})))};function de(e){switch(e){case"active":return 0;case"in-backlog":return 1;case"created":return 2;case"finished":return 3;case"abandoned":return 4}}function fe(e,t){return e.state!==t.state?de(e.state)<de(t.state)?-1:1:e.title.localeCompare(t.title)}function me(){var e=r.a.useContext(M),t=r.a.useState(!1),a=Object(p.a)(t,2),n=a[0],i=a[1],c=r.a.useState(""),s=Object(p.a)(c,2),o=s[0],l=s[1],u=r.a.useState(!1),d=Object(p.a)(u,2),f=d[0],m=d[1];return r.a.createElement(oe,{headerControls:r.a.createElement(U,{onClick:function(){return i(!n)},isLight:!0,title:"Filtrer"},r.a.createElement(le,{height:20,width:20,stroke:"white"}))},r.a.createElement("div",{className:_.a.taskList},r.a.createElement(ue,{visible:n,text:o,textChanged:l}),r.a.createElement("div",{className:_.a.tasks},function(e,t){var a=Object.keys(e).map((function(t){return e[t]})).sort(fe);return t&&(t=t.toLowerCase(),a=a.filter((function(e){return e.title.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)}))),a}(e,n?o:"").map((function(e){return r.a.createElement(se,{key:e.id,task:e})}))),r.a.createElement("div",{className:_.a.tasksButtons},r.a.createElement(U,{isWide:!0,onClick:function(){return m(!0)}},"+")),f&&r.a.createElement(ce,{task:void 0,onClose:function(){return m(!1)}})))}var he=a(17),ve=a.n(he),ke=function(e){var t=e.svg,a=e.size;return r.a.createElement("div",{className:ve.a.iconPreview},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t},style:{height:a,width:a}}))},pe=function(){var e=r.a.useState(""),t=Object(p.a)(e,2),a=t[0],n=t[1];return r.a.createElement("div",{className:ve.a.iconDesigner},r.a.createElement("textarea",{value:a,onChange:function(e){return n(e.target.value)}}),r.a.createElement(ke,{svg:a,size:200}),r.a.createElement(ke,{svg:a,size:100}),r.a.createElement(ke,{svg:a,size:50}),r.a.createElement(ke,{svg:a,size:32}),r.a.createElement(ke,{svg:a,size:25}))};function be(){var e=Object(u.g)();return r.a.createElement(r.a.Fragment,null,"Invalid path: \xab ",e.pathname," \xbb")}var _e=function(){return r.a.createElement("div",{className:l.a.app},r.a.createElement(k,null,r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/",exact:!0},r.a.createElement(u.a,{to:"/tasks"})),r.a.createElement(u.b,{path:"/home",exact:!0},r.a.createElement(oe,null,"Home page",r.a.createElement(pe,null))),r.a.createElement(u.b,{path:"/tasks",exact:!0},r.a.createElement(me,null)),r.a.createElement(u.b,{path:"*"},r.a.createElement(be,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement((function(){return r.a.createElement(P,null,r.a.createElement(s.a,null,r.a.createElement(_e,null)))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[35,1,2]]]);
//# sourceMappingURL=main.5da81f8c.chunk.js.map